/*
JSONext library. Copyright (C) techspider 2019.
Licensed under GNU GPLv3.
*/
"use strict";function _defineProperty(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function _instanceof(e,n){return null!=n&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](e):e instanceof n}!function(){var e=["date","symbol","escape","regexp"],n=JSON,t=_defineProperty({defineTransformation:function(n,t){if(!e.includes(n.toLowerCase()))throw new Error('The transformation "'.concat(n,'" is not a valid transformation.'));return"@T(".concat(n,", [").concat(t,"])")},stringify:function(e,r,i){return null!=r&&"function"!=typeof r?n.stringify(e,r,i):n.stringify(e,function(e,n){var i=e,o=n;return Number.isNaN(o)?o=t.defineTransformation("Symbol","NaN"):_instanceof(o,Date)?o=t.defineTransformation("Date",o.toUTCString()):_instanceof(o,RegExp)?o=t.defineTransformation("RegExp",o.source):"string"==typeof o&&o.startsWith("@T")?o=t.defineTransformation("Escape",o):o==1/0&&(o=t.defineTransformation("Symbol","Infinity")),null==r?o:r(i,o)},i)},process:function(e){for(var n=e,t=0,r=!1,i=0;i<n.length;i++)if("\\"!=n[i])if('"'!=n[i]||1==t)if('"'!=n[i]||1!=t){if(r)r=!1;else if(i+1<n.length){if(0!=t)continue;if("/"==n[i]&&"/"==n[i+1]){var o=n.indexOf("\n",i);-1==o&&(o=n.length);var a=n.substring(0,i),s=n.substring(o,n.length);n=a+s}else if("/"==n[i]&&"*"==n[i+1]){var f=n.indexOf("*/",i);if(-1==f)throw new SyntaxError("Failed to parse JSONext, missing matching */ for multi line comment at char "+(i+1));a=n.substring(0,i),s=n.substring(f+2,n.length);n=a+s,i-=1}}}else{if(r)continue;t=0}else t=1;else{if(r){r=!1;continue}r=!0}return n},parse:function(e,t){return n.parse(this.process(e),function(e,n){var r=e,i=n;if("string"==typeof i&&i.startsWith("@T")){var o=i.trim();if(!o.startsWith("(")&&!o.endsWith(")"))throw new SyntaxError('Incomplete transformation specifier for property "'+r+'"');var a=(o=o.substring(3,o.length-1)).substr(0,o.indexOf(",")).toLowerCase(),s=o.substring(o.indexOf("[")+1,o.lastIndexOf("]"));switch(a){default:throw new Error('Transformation "'.concat(a,'" is not supported.'));case"date":i=new Date(s);break;case"regexp":i=new RegExp(s);break;case"escape":i=s;break;case"symbol":switch(s.toLowerCase()){default:throw new Error('"'.concat(s,'" is not a recognized symbol specifier.'));case"nan":i=NaN;break;case"infinity":i=1/0}}}return null==t?i:t(r,i)})}},Symbol.toStringTag,"JSONext");"undefined"!=typeof window?window.JSONext=t:module.exports=t}();